= form_for widget.comments.new, :html => {:id => "comment_instream_#{widget.id}" } do |f|
  .field.comment_instream
    = f.label "add new comment:"
    = f.text_field :content
  %input{:type => "hidden", :name => "comment[creator_id]", :value => "#{current_user.id}"}
  %input{:type => "hidden", :name => "comment[widget_id]", :value => "#{widget.id}"}

  .actions
    = f.submit 'add comment'
    
:javascript
  $(function(){
     var reload_widgets = function(){
        $("#canvas-widgets").load("/canvae/#{widget.canvas.id}/widgets");
      }
    
    $("#comment_instream_#{widget.id}").submit(function(event){
      $.post($(this).attr("action"), $(this).serialize(), function(){
        reload_widgets();
      });
      event.preventDefault();
    });
  })